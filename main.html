<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Post</title>
</head>
<body>
    <h1>Create New Post</h1>
    <form id="postForm" enctype="multipart/form-data">
        <div>
            <label for="userId">User ID:</label>
            <input type="text" id="userId" name="userId" required>
        </div>
        <div>
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div>
            <label for="type">Type:</label>
            <input type="text" id="type" name="type" required>
        </div>
        <div>
            <label for="address">Address:</label>
            <input type="text" id="address" name="address" required>
        </div>
        <div>
            <label for="price">Price:</label>
            <input type="number" id="price" name="price" required>
        </div>
        <div>
            <label for="acreage">Acreage:</label>
            <input type="number" id="acreage" name="acreage" required>
        </div>
        <div>
            <label for="realaddress">Real Address:</label>
            <input type="text" id="realaddress" name="realaddress" required>
        </div>
        <div>
            <label for="owner">Owner:</label>
            <input type="text" id="owner" name="owner" required>
        </div>
        <div>
            <label for="phoneOwner">Phone Owner:</label>
            <input type="text" id="phoneOwner" name="phoneOwner" required>
        </div>
        <div>
            <label for="description">Description:</label>
            <textarea id="description" name="description" required></textarea>
        </div>
        <div>
            <label>Amenities:</label><br>
        
            <label for="fully_furnished">
                <input type="checkbox" id="fully_furnished" name="amenities[0]" value="1"> Đầy đủ nội thất
            </label><br>
        
            <label for="garret">
                <input type="checkbox" id="garret" name="amenities[1]" value="1"> Có gác
            </label><br>
        
            <label for="washing_machine">
                <input type="checkbox" id="washing_machine" name="amenities[2]" value="1"> Có máy giặt
            </label><br>
        
            <label for="free_time">
                <input type="checkbox" id="free_time" name="amenities[3]" value="1"> Giờ giấc tự do
            </label><br>
        
            <label for="fridge">
                <input type="checkbox" id="fridge" name="amenities[4]" value="1"> Có tủ lạnh
            </label><br>
        
            <label for="protect">
                <input type="checkbox" id="protect" name="amenities[5]" value="1"> Có bảo vệ 24/24
            </label><br>
        
            <label for="kitchen_shelf">
                <input type="checkbox" id="kitchen_shelf" name="amenities[6]" value="1"> Có kệ bếp
            </label><br>
        
            <label for="elevator">
                <input type="checkbox" id="elevator" name="amenities[7]" value="1"> Có thang máy
            </label><br>
        
            <label for="common_owner">
                <input type="checkbox" id="common_owner" name="amenities[8]" value="1"> Không chung chủ
            </label><br>
        
            <label for="air_conditioner">
                <input type="checkbox" id="air_conditioner" name="amenities[9]" value="1"> Có máy lạnh
            </label><br>
        
            <label for="parking">
                <input type="checkbox" id="parking" name="amenities[10]" value="1"> Có hầm/chỗ để xe
            </label><br>
        
        </div>
        
        <div>
            <label for="files">Upload Files (Images/Videos):</label>
            <input type="file" id="files" name="files" multiple required>
        </div>
        <button type="submit">Create Post</button>
    </form>

    <script>
        document.getElementById("postForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            // Lấy dữ liệu từ form
            const formData = new FormData(this);

            // Chuyển đổi dữ liệu amenities thành mảng các số
            const amenities = formData.get("amenities").split(",").map(item => parseInt(item.trim()));
            formData.set("amenities", JSON.stringify(amenities));

            try {
                const response = await fetch('/api/posts/create', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                if (response.ok) {
                    alert("Post created successfully!");
                    console.log(result);
                } else {
                    alert("Error creating post: " + result.message);
                    console.error(result);
                }
            } catch (error) {
                console.error("Error:", error);
                alert("There was an error with the upload.");
            }
        });
    </script>
</body>
</html>
